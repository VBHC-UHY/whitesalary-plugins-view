<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™½çš„æ’ä»¶å¸‚åœº - åœ¨çº¿æµè§ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Noto Sans SC', sans-serif; }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .hero-section {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%);
        }
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }
        .featured-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
        }
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #4f46e5 0%, #9333ea 100%);
        }
        .stat-box {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border-radius: 16px;
        }
        .category-btn {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            border: 1px solid #e5e7eb;
            color: #4b5563;
        }
        .category-btn:hover {
            border-color: #a855f7;
            color: #a855f7;
        }
        .category-btn.active {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            color: white;
            border-color: transparent;
        }
        .search-box {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px 16px 12px 48px;
            font-size: 16px;
            width: 100%;
            transition: all 0.2s;
        }
        .search-box:focus {
            outline: none;
            border-color: #a855f7;
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }
        .notice-bar {
            background: linear-gradient(90deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid #f59e0b;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨è‹±é›„åŒº -->
    <div class="hero-section text-white">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="flex flex-col lg:flex-row items-center justify-between gap-6">
                <!-- å·¦ä¾§æ ‡é¢˜ -->
                <div class="flex items-center gap-4">
                    <div class="text-5xl">ğŸª</div>
                    <div>
                        <h1 class="text-3xl font-bold">ç™½çš„æ’ä»¶å¸‚åœº</h1>
                        <p class="text-white/80 text-sm mt-1">ä¸“ä¸ºç™½æ‰“é€ çš„æ‰©å±•åŠŸèƒ½ä¸­å¿ƒ Â· åœ¨çº¿æµè§ˆç‰ˆ</p>
                    </div>
                </div>
                
                <!-- ä¸­é—´ç»Ÿè®¡ -->
                <div class="flex items-center gap-3">
                    <div class="stat-box px-5 py-3 text-center">
                        <div class="text-2xl font-bold" id="stat-total">-</div>
                        <div class="text-xs text-white/70">ğŸ“¦ å¯ç”¨æ’ä»¶</div>
                    </div>
                    <div class="stat-box px-5 py-3 text-center">
                        <div class="text-2xl font-bold" id="stat-featured">-</div>
                        <div class="text-xs text-white/70">â­ ç²¾é€‰æ¨è</div>
                    </div>
                    <div class="stat-box px-5 py-3 text-center">
                        <div class="text-2xl font-bold" id="stat-categories">-</div>
                        <div class="text-xs text-white/70">ğŸ·ï¸ æ’ä»¶åˆ†ç±»</div>
                    </div>
                </div>
                
                <!-- å³ä¾§æŒ‰é’® -->
                <div class="flex items-center gap-2">
                    <button onclick="goLocal()" class="px-4 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-sm font-medium transition">
                        ğŸ  è¿›å…¥æœ¬åœ°å¸‚åœº
                    </button>
                    <a href="https://whitesalary-plugins-web.vercel.app" target="_blank" class="px-4 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-sm font-medium transition">
                        ğŸ“¤ æäº¤æ’ä»¶
                    </a>
                    <a href="https://github.com/VBHC-UHY/whitesalary-plugins" target="_blank" class="px-4 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-sm font-medium transition">
                        ğŸ“‚ GitHub
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- æç¤ºæ¡ -->
    <div class="notice-bar mx-auto max-w-7xl mt-4 rounded-lg px-4 py-3 mx-4 flex items-center gap-2 text-sm">
        <span class="text-amber-600">ğŸ’¡</span>
        <span class="text-amber-800">æ­¤é¡µé¢ä»…ä¾›æµè§ˆï¼Œå¦‚éœ€å®‰è£…æ’ä»¶è¯·ç‚¹å‡»ã€Œè¿›å…¥æœ¬åœ°å¸‚åœºã€ï¼ˆéœ€å…ˆå¯åŠ¨æœ¬åœ°æœåŠ¡ï¼‰</span>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- æœç´¢å’Œç­›é€‰ -->
        <div class="glass rounded-2xl p-5 mb-6">
            <div class="flex flex-col md:flex-row gap-4 items-center">
                <div class="flex-1 relative w-full">
                    <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="æœç´¢æ’ä»¶åç§°ã€æè¿°..." class="search-box">
                </div>
                <select id="categorySelect" class="px-4 py-3 rounded-xl bg-white border-2 border-gray-200 focus:border-purple-400 focus:outline-none cursor-pointer min-w-[140px]">
                    <option value="">å…¨éƒ¨åˆ†ç±»</option>
                </select>
            </div>
            
            <!-- åˆ†ç±»æ ‡ç­¾ -->
            <div class="mt-4 flex flex-wrap gap-2" id="categoryTags">
                <button class="category-btn active" data-cat="" onclick="filterCat('')">ğŸ“‹ å…¨éƒ¨</button>
            </div>
        </div>

        <!-- ç²¾é€‰åŒºåŸŸ -->
        <div id="featuredArea" class="mb-8 hidden">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">â­ ç²¾é€‰æ¨è</h2>
            <div id="featuredList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        </div>

        <!-- æ‰€æœ‰æ’ä»¶ -->
        <div>
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                ğŸ“¦ æ‰€æœ‰æ’ä»¶ <span class="text-gray-400 font-normal text-base" id="countText"></span>
            </h2>
            <div id="pluginList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <div class="col-span-full text-center py-12">
                    <div class="text-4xl mb-3">â³</div>
                    <p class="text-gray-500">æ­£åœ¨åŠ è½½æ’ä»¶...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <div id="modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 hidden" onclick="if(event.target===this)closeModal()">
        <div class="bg-white rounded-2xl w-full max-w-xl max-h-[80vh] overflow-hidden shadow-2xl">
            <div id="modalHeader" class="p-5 bg-gradient-to-r from-purple-50 to-pink-50 border-b"></div>
            <div id="modalBody" class="p-5 overflow-y-auto" style="max-height: calc(80vh - 180px);"></div>
            <div class="p-4 border-t bg-gray-50 flex items-center justify-between">
                <a id="modalGithub" href="#" target="_blank" class="text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1">
                    ğŸ“‚ æŸ¥çœ‹æºä»£ç 
                </a>
                <div class="flex gap-2">
                    <button onclick="closeModal()" class="px-4 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100 text-sm">å…³é—­</button>
                    <button onclick="installPlugin()" class="btn-primary px-4 py-2 rounded-lg text-white text-sm">ğŸ”— å®‰è£…</button>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨ -->
    <footer class="border-t border-white/20 mt-8 bg-white/30 backdrop-blur">
        <div class="max-w-7xl mx-auto px-4 py-5 flex flex-col md:flex-row items-center justify-between gap-3 text-sm text-gray-600">
            <span>ğŸª ç™½çš„æ’ä»¶å¸‚åœº - åœ¨çº¿æµè§ˆç‰ˆ</span>
            <div class="flex items-center gap-4">
                <a href="https://github.com/VBHC-UHY/whitesalary-plugins" target="_blank" class="hover:text-purple-600">ğŸ“‚ GitHubä»“åº“</a>
                <a href="https://whitesalary-plugins-web.vercel.app" target="_blank" class="hover:text-purple-600">ğŸ“¤ æäº¤æ’ä»¶</a>
                <button onclick="goLocal()" class="hover:text-purple-600">ğŸ  æœ¬åœ°å¸‚åœº</button>
            </div>
        </div>
    </footer>

    <script>
        // é…ç½®
        const GITHUB_RAW = 'https://raw.githubusercontent.com/VBHC-UHY/whitesalary-plugins/main/plugins.json';
        const GITHUB_REPO = 'https://github.com/VBHC-UHY/whitesalary-plugins/tree/main/plugins/';
        const LOCAL_URL = 'http://127.0.0.1:5266';
        
        // æ•°æ®
        let plugins = [];
        let currentPlugin = null;
        let currentCat = '';
        
        // åˆ†ç±»å›¾æ ‡
        const icons = {
            'å¨±ä¹': 'ğŸ®', 'å®ç”¨': 'ğŸ› ï¸', 'ç¤¾äº¤': 'ğŸ’¬', 'AI': 'ğŸ¤–',
            'éŸ³ä¹': 'ğŸµ', 'å›¾ç‰‡': 'ğŸ–¼ï¸', 'è§†é¢‘': 'ğŸ“¹', 'åª’ä½“': 'ğŸ“º',
            'æ–°é—»': 'ğŸ“°', 'å¤©æ°”': 'ğŸŒ¤ï¸', 'æœç´¢': 'ğŸ”', 'ç¿»è¯‘': 'ğŸŒ',
            'è‡ªåŠ¨åŒ–': 'âš¡', 'æé†’': 'â°', 'æ•°æ®': 'ğŸ“Š', 'å¼€å‘': 'ğŸ’»',
            'å åœ': 'ğŸ”®', 'æ¶æ': 'ğŸƒ', 'è§’è‰²': 'ğŸ­', 'æŠ½å¥–': 'ğŸ°',
            'ç”Ÿæ´»': 'ğŸ ', 'å­¦ä¹ ': 'ğŸ“š', 'è´¢åŠ¡': 'ğŸ’°', 'å¥åº·': 'ğŸ’ª',
            'ç¾¤ç®¡': 'ğŸ‘®', 'ç»Ÿè®¡': 'ğŸ“ˆ', 'äº’åŠ¨': 'ğŸ‰',
            'ç³»ç»Ÿ': 'âš™ï¸', 'è¡¨æƒ…': 'ğŸ˜Š', 'è®¡ç®—': 'ğŸ§®', 'å…¶ä»–': 'ğŸ“¦'
        };
        
        // åˆå§‹åŒ–
        async function init() {
            try {
                // åŠ ç¼“å­˜ç ´åå‚æ•°ç¡®ä¿è·å–æœ€æ–°
                const res = await fetch(GITHUB_RAW + '?t=' + Date.now());
                if (!res.ok) throw new Error('HTTP ' + res.status);
                const data = await res.json();
                plugins = data.plugins || [];
                
                // æ›´æ–°ç»Ÿè®¡
                const statTotal = document.getElementById('stat-total');
                const statFeatured = document.getElementById('stat-featured');
                const statCats = document.getElementById('stat-categories');
                
                if (statTotal) statTotal.textContent = plugins.length;
                
                const featuredCount = plugins.filter(p => p.featured).length;
                if (statFeatured) statFeatured.textContent = featuredCount;
                
                const cats = [...new Set(plugins.map(p => p.category).filter(Boolean))];
                if (statCats) statCats.textContent = cats.length;
                
                // å¡«å……åˆ†ç±»ä¸‹æ‹‰æ¡†
                const sel = document.getElementById('categorySelect');
                if (sel) {
                    cats.sort().forEach(cat => {
                        const opt = document.createElement('option');
                        opt.value = cat;
                        opt.textContent = (icons[cat] || 'ğŸ“¦') + ' ' + cat;
                        sel.appendChild(opt);
                    });
                }
                
                // å¡«å……åˆ†ç±»æ ‡ç­¾
                const tags = document.getElementById('categoryTags');
                if (tags) {
                    cats.sort().forEach(cat => {
                        const btn = document.createElement('button');
                        btn.className = 'category-btn';
                        btn.dataset.cat = cat;
                        btn.onclick = () => filterCat(cat);
                        btn.textContent = (icons[cat] || 'ğŸ“¦') + ' ' + cat;
                        tags.appendChild(btn);
                    });
                }
                
                render();
                renderFeatured();
            } catch (err) {
                const list = document.getElementById('pluginList');
                if (list) {
                    list.innerHTML = '<div class="col-span-full text-center py-12">' +
                        '<div class="text-4xl mb-3">ğŸ˜¢</div>' +
                        '<p class="text-gray-500">åŠ è½½å¤±è´¥: ' + err.message + '</p>' +
                        '<p class="text-gray-400 text-sm mt-1">è¯·åˆ·æ–°é¡µé¢é‡è¯•</p></div>';
                }
            }
        }
        
        // è¿‡æ»¤åˆ†ç±»
        function filterCat(cat) {
            currentCat = cat;
            document.querySelectorAll('.category-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.cat === cat);
            });
            const sel = document.getElementById('categorySelect');
            if (sel) sel.value = cat;
            render();
        }
        
        // æ¸²æŸ“ç²¾é€‰
        function renderFeatured() {
            const featured = plugins.filter(p => p.featured);
            const area = document.getElementById('featuredArea');
            const list = document.getElementById('featuredList');
            if (!area || !list) return;
            
            if (featured.length === 0) {
                area.classList.add('hidden');
                return;
            }
            area.classList.remove('hidden');
            list.innerHTML = featured.map(p => makeCard(p, true)).join('');
        }
        
        // æ¸²æŸ“åˆ—è¡¨
        function render() {
            const search = (document.getElementById('searchInput')?.value || '').toLowerCase();
            let list = plugins;
            
            if (search) {
                list = list.filter(p => 
                    (p.cn_name || '').toLowerCase().includes(search) ||
                    (p.name || '').toLowerCase().includes(search) ||
                    (p.description || '').toLowerCase().includes(search)
                );
            }
            if (currentCat) {
                list = list.filter(p => p.category === currentCat);
            }
            
            const countEl = document.getElementById('countText');
            if (countEl) countEl.textContent = '(' + list.length + 'ä¸ª)';
            
            const container = document.getElementById('pluginList');
            if (!container) return;
            
            if (list.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-12">' +
                    '<div class="text-4xl mb-3">ğŸ”</div>' +
                    '<p class="text-gray-500">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ’ä»¶</p></div>';
                return;
            }
            container.innerHTML = list.map(p => makeCard(p)).join('');
        }
        
        // åˆ›å»ºå¡ç‰‡
        function makeCard(p, featured) {
            const icon = icons[p.category] || 'ğŸ“¦';
            return '<div onclick="showDetail(\'' + p.id + '\')" class="card p-4 cursor-pointer ' + (featured ? 'featured-card' : '') + '">' +
                '<div class="flex items-start gap-3 mb-2">' +
                '<div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center text-xl">' + icon + '</div>' +
                '<div class="flex-1 min-w-0">' +
                '<div class="flex items-center gap-2">' +
                '<h3 class="font-bold text-gray-800 truncate text-sm">' + (p.cn_name || p.name) + '</h3>' +
                (p.featured ? '<span class="bg-amber-400 text-white text-xs px-1.5 py-0.5 rounded">ç²¾é€‰</span>' : '') +
                '</div>' +
                '<p class="text-xs text-gray-400">v' + p.version + ' Â· ' + p.author + '</p>' +
                '</div></div>' +
                '<p class="text-gray-600 text-xs mb-2 line-clamp-2">' + p.description + '</p>' +
                '<div class="flex items-center justify-between text-xs">' +
                '<span class="px-2 py-0.5 rounded-full bg-purple-50 text-purple-600">' + icon + ' ' + p.category + '</span>' +
                '<span class="text-gray-400">â¬‡ï¸' + (p.downloads || 0) + '</span>' +
                '</div></div>';
        }
        
        // æ˜¾ç¤ºè¯¦æƒ…
        function showDetail(id) {
            currentPlugin = plugins.find(p => p.id === id);
            if (!currentPlugin) return;
            
            const icon = icons[currentPlugin.category] || 'ğŸ“¦';
            const header = document.getElementById('modalHeader');
            const body = document.getElementById('modalBody');
            const github = document.getElementById('modalGithub');
            
            if (header) {
                header.innerHTML = '<div class="flex items-center gap-3">' +
                    '<div class="w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center text-3xl">' + icon + '</div>' +
                    '<div>' +
                    '<h2 class="text-xl font-bold text-gray-800">' + (currentPlugin.cn_name || currentPlugin.name) + '</h2>' +
                    '<p class="text-sm text-gray-500">v' + currentPlugin.version + ' Â· ' + currentPlugin.author + ' Â· ' + currentPlugin.category + '</p>' +
                    '</div></div>';
            }
            
            if (body) {
                let html = '<div class="space-y-4">';
                html += '<div><h3 class="font-bold text-gray-700 mb-1 text-sm">ğŸ“ ä»‹ç»</h3>' +
                    '<p class="text-gray-600 text-sm bg-gray-50 p-3 rounded-lg">' + (currentPlugin.full_description || currentPlugin.description) + '</p></div>';
                
                if (currentPlugin.features?.length) {
                    html += '<div><h3 class="font-bold text-gray-700 mb-1 text-sm">âœ¨ ç‰¹è‰²</h3><ul class="text-sm space-y-1">' +
                        currentPlugin.features.map(f => '<li class="flex items-center gap-1 text-gray-600"><span class="text-green-500">âœ“</span>' + f + '</li>').join('') +
                        '</ul></div>';
                }
                
                if (currentPlugin.commands?.length) {
                    html += '<div><h3 class="font-bold text-gray-700 mb-1 text-sm">âŒ¨ï¸ å‘½ä»¤</h3>' +
                        '<div class="flex flex-wrap gap-1">' +
                        currentPlugin.commands.map(c => '<code class="bg-purple-50 text-purple-600 px-2 py-0.5 rounded text-xs">' + c + '</code>').join('') +
                        '</div></div>';
                }
                
                html += '</div>';
                body.innerHTML = html;
            }
            
            if (github) github.href = GITHUB_REPO + currentPlugin.id;
            
            document.getElementById('modal')?.classList.remove('hidden');
        }
        
        function closeModal() {
            document.getElementById('modal')?.classList.add('hidden');
            currentPlugin = null;
        }
        
        function installPlugin() {
            if (currentPlugin) {
                window.open(LOCAL_URL + '/plugins/market?install=' + currentPlugin.id, '_blank');
            }
        }
        
        function goLocal() {
            window.open(LOCAL_URL + '/plugins/market', '_blank');
        }
        
        // äº‹ä»¶ç»‘å®š
        document.getElementById('searchInput')?.addEventListener('input', render);
        document.getElementById('categorySelect')?.addEventListener('change', function() {
            filterCat(this.value);
        });
        
        // å¯åŠ¨
        init();
    </script>
</body>
</html>
